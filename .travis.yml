# TravisCI configuration for Adyen/adyen-php-api-library

if: "branch = develop"

language: "php"
os:
  - "linux"
dist: "xenial"

matrix:
  fast_finish: true
  include:
    # Aliases to a recent PHP versions
    - php: "5.6"
    - php: "7.0"
    - php: "7.1"
    - php: "7.2"
    - php: "7.3"
    - php: "7.4"
      install:
        - "composer install"
      script:
        # Search for PHP syntax errors, ignores `vendor` and `tests` directories, then search for files with `php` extension only
        - |
          find -L . -path ./vendor -prune -o -path ./tests -prune -o -name '*.php' -print0 | xargs -0 -n 1 -P 4 php -l
        # Run unit tests and check coding standard
        - "vendor/bin/phpunit --testsuite=unit"
        - "vendor/bin/phpcs"
    - php: "8.0"
  allow_failures:
    - php: "8.0"

script:
  - |
    find -L . -path ./vendor -prune -o -path ./tests -prune -o -name '*.php' -print0 | xargs -0 -n 1 -P 4 php -l
